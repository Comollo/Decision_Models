library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print(getwd())
library(readxl)
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
#PARTE Gabry
d.raw %>% group_by(Casino, Section, Denomination, MachineType) %>%
summarise(AvgGrossRevenue = mean(GrossRevenuePerMachine),
AvgPlays = mean(PlaysPerMachine),
TotGrossRevenue = sum(GrossRevenue),
TotPlays = sum(PlaysPerMachine),
NoMachines = sum(NoMachines),
DistinctMachines = n()) %>%
View()
#Status Dataset
library(funModeling)
library(dplyr)
#Aggregazione Gabry
d.raw %>% group_by(Casino, Section, Denomination, MachineType) %>%
summarise(AvgGrossRevenue = mean(GrossRevenuePerMachine),
AvgPlays = mean(PlaysPerMachine),
TotGrossRevenue = sum(GrossRevenue),
TotPlays = sum(PlaysPerMachine),
NoMachines = sum(NoMachines),
DistinctMachines = n()) %>%
View()
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print(getwd())
library(readxl)
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
View(d)
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
#Status Dataset
library(funModeling)
library(dplyr)
status = df_status(d, print_results = F)
summary(d$Month) #circa 12 mesi
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
d_aries = d %>%
filter(Casino == "Aries")
d_aries %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali Aries per mese = OK!
d_libra = d %>%
filter(Casino == "Libra")
d_libra %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines))#macchine totali Libra per mese = OK!
#numero di "macchine" che posso avere
slots_unique <- d %>%
group_by(Denomination, MachineName, MachineType, Model, Manufacturer) %>%
summarise(monthRevenue =
mean(GrossRevenuePerMachine),
monthPlays = mean(PlaysPerMachine),
revenuePerPlay = monthRevenue / monthPlays , count = n())
View(d_libra)
View(d_aries)
d_aries %>%
filter(MachineName == "Breakstone",
MachineType == "video",
Model == "Aeolian PRO Vision")
d_aries %>%
filter(MachineName == "Breakstone",
MachineType == "video",
Model == "Aeolian PRO Vision") %>%
View()
d_aries %>%
filter(NoMachines > 1) %>%
View()
d_aries %>%
filter(NoMachines > 1,
Denomination == "0.05",
MachineType == "reel") %>%
View()
d_aries %>%
filter(NoMachines > 1,
Denomination == "0.02",
MachineType == "reel"
) %>%
View()
d_aries %>%
filter(NoMachines > 1,
Denomination == "0.02",
MachineType == "reel"
) %>%
arrange(MachineName, Model) %>%
View()
d_aries %>%
filter(NoMachines > 1,
Denomination == "0.02",
MachineType == "reel"
) %>%
arrange(MachineName, Model, Month) %>%
View()
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
d_aries %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali Aries per mese = OK!
d_libra = d %>%
filter(Casino == "Libra")
d_libra %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines))#macchine totali Libra per mese = OK!
#numero di "macchine" che posso avere
slots_unique <- d %>%
group_by(Denomination, MachineName, MachineType, Model, Manufacturer) %>%
summarise(monthRevenue =
mean(GrossRevenuePerMachine),
monthPlays = mean(PlaysPerMachine),
revenuePerPlay = monthRevenue / monthPlays , count = n())
View(slots_unique) #556
#Considero solo il mese di Settembre
sept_lib = d_libra %>%
filter (Month == ymd("2011-09-01")) #Voi usate pure as.Date()
library(lubridate)
#Considero solo il mese di Settembre
sept_lib = d_libra %>%
filter (Month == ymd("2011-09-01")) #Voi usate pure as.Date()
sum(sept_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
sept_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
sept_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) %>%
View()#ok
isopectic <- d %>% filter( MachineName == "Isopectic Encoding", Denomination == 2, MachineType == "video", Model == "Mirier") %>%
arrange(Month)
View(isopectic)
isopectic <- d %>% filter( Casino == "Aries", MachineName == "Isopectic Encoding", Denomination == 2, MachineType == "video", Model == "Mirier") %>%
arrange(Month)
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines),
varianza_configurazione = var(n_mac)) #macchine totali di LDE per mese
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines),
varianza_configurazione = var(n_mac)) #macchine totali di LDE per mese
var(c(5,6))
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines),
varianza_configurazione = var(as.numeric(n_mac))) #macchine totali di LDE per mese
varianza_configurazione = var(sum(NoMachines)) #macchine totali di LDE per mese
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines),
varianza_configurazione = var(sum(NoMachines))) #macchine totali di LDE per mese
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
