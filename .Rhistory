plot(x = df$Month, y = df$ricavo_unitario)
boxplot(df$ricavo_unitario)
View(d)
sum(d%GrossRevenue)
sum(d$GrossRevenue)
#keep calm: first exploration
library(ggplot2)
ggplot(data=d, aes(x=d$Month, y = d$GrossRevenue)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="Gross Revenue") +
theme_classic()
###########################################################################################################################################
# CODE 2
###########################################################################################################################################
options(scipen = 999)
ggplot(data=d, aes(x=d$Month, y = d$GrossRevenue)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="Gross Revenue") +
theme_classic()
ggplot(data=d, aes(x=d$Month, y = d$GrossRevenuePerMachine)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="Gross Revenue") +
theme_classic()
ggplot(data=d, aes(x=d$Month, y = d$GrossRevenuePerMachine)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="Gross Revenue per Machine") +
theme_classic()
View(d)
#pacchetto per le serie storiche (guarda anche Rmetrics)
install.packages("timeSeries")
library(timeSeries)
data("MSFT")
View(MSFT)
time(MSFT) #restituisce le date
series(MSFT) #crea una matrice -> corrisponde ad una serie
plot(y)
y <- align(MSFT[, "Close"])
med <- rollMedian(y, 5, align = "right") #mediana mobile
plot(y)
time(d)
View(MSFT)
MSFT@.Data
time(df)
help("time")
df %>%
group_by(Month) %>%
summarise(avg = mean(ricavi_totali))
df %>%
group_by(Month) %>%
summarise(avg = mean(ricavi_totali),
macchine = mean(numero_macchine))
mean(3,8)
mean(c(3,8)
)
3+8/2
3+8
11/2
library(lubridate)
sum(df$Month == ymd("2011-09-01"))
sum(df[Month == ymd("2011-09-01"),Month])
sum(df[Month == ymd("2011-09-01"),d$Month])
sum(df[Month == ymd("2011-09-01"),df$ricavi_totali])
df[44,"ricavi_totali"]
df[1:44,"ricavi_totali"]
sum(df[1:44,"ricavi_totali"])
sum(df[1:44,"ricavi_totali"])/44
ricavi_mese = df %>%
group_by(Month) %>%
summarise(avg = mean(ricavi_totali))
View(ricavi_mese)
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.1, size=4, color="#880011") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.3, size=0.5, color="#880011") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.5, size=1, color="#880011") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.5, size=1, color="#880011") +
geom_tile("Ricavi medi per Mese")
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.5, size=1, color="#880011") +
geom_tile("Ricavi medi per Mese") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtile("Ricavi medi per Mese") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$avg)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi medi per Mese") +
labs(x="Month", y="avg Gross Revenue") +
theme_classic()
d %>%
filter(Casino== "Aries") %>%
group_by(Month) %>%
summarise(mean(GrossRevenue))
d %>%
filter(Casino== "Aries") %>%
group_by(Month) %>%
summarise(mean(GrossRevenue)) %>%
View()
View(d)
d %>%
filter(Casino== "Aries") %>%
group_by(Month) %>%
summarise(GrossRevenue) %>%
View()
d %>%
filter(Casino== "Aries") %>%
group_by(Month) %>%
View()
View(d)
d %>%
filter(Casino == "Aries") %>%
View()
d %>%
filter(Casino == "Aries") %>%
View()
d %>%
filter(Casino == "Aries")
d %>%
filter(Casino == "Aries")
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
d %>%
filter(Casino == "Aries")
colnames(d)
#aries
d_aries = d %>%
filter(Casino == "Aries")
View(d_aries)
###########################################################################################################################################
# CODE 2
###########################################################################################################################################
options(scipen = 999)
library(rstudioapi)
#Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print(getwd())
library(readxl)
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
library(funModeling)
library(dplyr)
library(lubridate)
#status
status = df_status(d, print_results = F)
summary(d$Month) #12 mesi
#aries
d_aries = d %>%
filter(Casino == "Aries")
#libra
d_libra = d %>%
filter(Casino == "Libra")
df = d_aries %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(numero_macchine = sum(NoMachines),
ricavi_totali = sum(GrossRevenue),
ricavo_unitario = ricavi_totali/numero_macchine,
giocate_totali = sum(Plays),
giocate_unitarie = round(giocate_totali/numero_macchine),
ricavo_per_giocata = ricavi_totali/giocate_totali) %>%
arrange(Month, Section, MachineType, Denomination)
d %>%
filter(Casino == "Aries")
d %>%
filter(Casino == "Aries") %>%
group_by(Month) %>%
summarise(mean(GrossRevenue))
d %>%
filter(Casino == "Aries") %>%
group_by(Month) %>%
View()
ricavi_mese = df %>%
group_by(Month) %>%
summarise(avg = mean(ricavi_totali))
View(ricavi_mese)
d %>%
filter(Casino == "Aries") %>%
group_by(Month) %>%
summarise(mean(GrossRevenue))
View(df)
mean(d_aries[d_aries$Month == ymd("2011-09-01"), "GrossRevenue"])
d_aries[d_aries$Month == ymd("2011-09-01"), d_aries$GrossRevenue])
d_aries[d_aries$Month == ymd("2011-09-01"), d_aries$GrossRevenue]
d_aries$Month == ymd("2011-09-01")
d_aries[d_aries$Month == ymd("2011-09-01"),]
d_aries[d_aries$Month == ymd("2011-09-01"),d_aries$Month]
d_aries[d_aries$Month == ymd("2011-09-01"),d_aries$MachineType]
df %>% arrange(Month)
View(d_aries)
d_aries%>% arrange(Month)
View(d_aries)
d_aries = d_aries%>% arrange(Month)
View(d_aries)
d_aries[d_aries$Month == ymd("2011-09-01"),d_aries$GrossRevenue]
sum(d_aries[d_aries$Month == ymd("2011-09-01"),d_aries$GrossRevenue])
sum(435,d_aries$GrossRevenue])
sum(d_aries[│1:435],d_aries$GrossRevenue])
sum(d_aries[1:435,d_aries$GrossRevenue])
d %>%
filter(Casino == "Aries") %>%
group_by(Month) %>%
summarise(sum(GrossRevenue))
ricavi_mese = df %>%
group_by(Month) %>%
summarise(avg = sum(ricavi_totali))
View(ricavi_mese)
ricavi_mese = df %>%
group_by(Month) %>%
summarise(ricavo_tot_mese = sum(ricavi_totali))
View(ricavi_mese)
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_tot_mese)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Mese") +
labs(x="Mese", y="Ricavo Tot") +
theme_classic()
ricavi_mese = df %>%
group_by(Month) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario))
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_medio_unitario) +
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Mese") +
labs(x="Mese", y="Ricavo Tot") +
theme_classic()
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Mese") +
labs(x="Mese", y="Ricavo medio unitario") +
theme_classic()
ricavi_mese = df %>%
group_by(Month) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario))
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Mese") +
labs(x="Mese", y="Ricavo medio unitario") +
theme_classic()
mean(df[1:44, "ricavo_unitario"])
mean(df[1:44, d$ricavo_unitario])
mean(df[1:44, df$ricavo_unitario])
df[1:44, df$ricavo_unitario]
df[df$ricavo_unitario, 1:44]
df[1:44]
df[1:44,]
df[1:44,7]
mean(df[1:44,7])
e = df[1:44,7]
e = as.vector(df[1:44,7])
View(e)
mean(e)
summary(e)
View(e)
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario))
View(ricavi_categoria)
View(df)
df %>% filter (Month == ymd("2011-09-01")) %>% group_by(Denomination, MachineType)
df %>% filter (Month == ymd("2011-09-01")) %>% group_by(Denomination, MachineType) %>% View()
df %>% filter (Month == ymd("2011-09-01")) %>% group_by(Denomination, MachineType) %>% summarise(n =n())
df %>% group_by(Month,Denomination, MachineType) %>% summarise(n =n())
df %>% group_by(Month,Denomination, MachineType) %>% summarise(n =n()) %>% View()
154/13
12*11
132+13
154/13
df %>% group_by(Month,Denomination, MachineType) %>% summarise(n =n()) %>% View()
catgeorie_mese =
df %>%
group_by(Month,Denomination, MachineType) %>%
summarise(n =n()) %>%
mutate(n_categorie = sum(n))
View(catgeorie_mese)
catgeorie_mese =
df %>%
group_by(Month,Denomination, MachineType) %>%
summarise(n =n()) %>%
group_by(Month) %>%
summarise(n1 = n())
View(catgeorie_mese)
catgeorie_mese =
df %>%
group_by(Month,Denomination, MachineType) %>%
summarise(n =n()) %>%
group_by(Month) %>%
summarise(numero_categorie = n())
View(catgeorie_mese)
13*10
130+12+12
df %>%
group_by(Month, Denomination, MachineType, Section) %>%
summarise(n =n()) %>% View()
df %>%
group_by(Section, Month) %>%
summarise(n =n())
df %>%
group_by(Section, Month) %>%
summarise(n =n()) %>%
View()
df %>%
group_by(Denomination, MachineType) %>%
summarise(n = n())
ggplot(data=df, aes(x=df$ricavo_unitario)) +
geom_histogram(fill="#880011") +
labs(x="Ricavo unitario", y="Count\nof Records") +
theme_minimal()
ggplot(data=df, aes(x=df$ricavo_unitario)) +
geom_histogram(fill="#880011") +
labs(x="Ricavo unitario", y="Count\nof Records") +
facet_wrap(~df$Month)
ggplot(data=df, aes(x=df$ricavo_unitario)) +
geom_point(fill="#880011") +
labs(x="Ricavo unitario", y="Count\nof Records") +
facet_wrap(~df$Month)
theme_minimal()
theme_minimal()
ggplot(data=df, aes(x=df$ricavo_unitario)) +
geom_histogram(fill="#880011") +
labs(x="Ricavo unitario", y="Count\nof Records") +
facet_wrap(~df$Month) +
theme_minimal()
rm(e)
View(ricavi_categoria)
ggplot(data=ricavi_mese, aes(x=ricavi_categoria$Month, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(cat = coalesce(Denomination, MachineType))
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(cat = (Denomination, MachineType))
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(type = paste0(Denomination,MachineType))
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(type = paste0(Denomination,MachineType, sep = "_"))
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(type = paste0(Denomination,sep = "_", MachineType))
ggplot(data=ricavi_mese, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(type = paste0(Denomination,sep = "_", MachineType))
ggplot(data=ricavi_mese, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
View(ricavi_categoria)
ggplot(data=ricavi_mese, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ricavi_categoria$type
ricavi_categoria$ricavo_medio_unitario
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=5, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=5, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=5, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=3, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
d_aries %>%
group_by(Denomination, MachineType) %>%
summarise(n = n())
d_aries %>%
group_by(Denomination, MachineType) %>%
summarise(n = n(), mac = sum(NoMachines), ricavi = sum(GrossRevenue), unitari = ricavi/mac)
ricavi_sezione = df %>%
group_by(Section) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario))
View(ricavi_sezione)
ggplot(data=ricavi_sezione, aes(x=ricavi_sezione$Section, y = ricavi_sezione$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=3, color="#880011") +
ggtitle("Ricavi per Sezione") +
labs(x="Sezione", y="Ricavo medio unitario") +
theme_classic()
d_aries %>%
group_by(Section) %>%
summarise(n = n(), mac = sum(NoMachines), ricavi = sum(GrossRevenue), unitari = ricavi/mac)
d_aries %>%
group_by(Section) %>%
summarise(n = n(), mac = sum(NoMachines), ricavi = sum(GrossRevenue), unitari = mean(GrossRevenuePerMachine))
df = d_aries %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(numero_macchine = sum(NoMachines),
ricavi_totali = sum(GrossRevenue),
ricavo_unitario = ricavi_totali/numero_macchine,
giocate_totali = sum(Plays),
giocate_unitarie = round(giocate_totali/numero_macchine),
ricavo_per_giocata = ricavi_totali/giocate_totali) %>%
arrange(Month, Section, MachineType, Denomination) %>%
mutate(tipo = paste0(Denomination, "_", MachineType))
df = d_aries %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(numero_macchine = sum(NoMachines),
ricavi_totali = sum(GrossRevenue),
ricavo_unitario = ricavi_totali/numero_macchine,
giocate_totali = sum(Plays),
giocate_unitarie = round(giocate_totali/numero_macchine),
ricavo_per_giocata = ricavi_totali/giocate_totali) %>%
arrange(Month, Section, MachineType, Denomination) %>%
mutate(tipo = paste0(MachineType, "_", Denomination))
df %>% group_by(tipo, Section) %>%
summarise(n = n())
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section)
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
View()
df %>% group_by(tipo, Section, Month) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
View()
13*4*12
13*4
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
View()
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View()
df %>% group_by(tipo, Section, Month) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View() #Nelle sezioni le categorie sono più o meno le stesse per tutto l'anno  = Ha senso questo raggruppamento
13*12
156*4
13*12*4
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View() #Nelle sezioni le categorie sono più o meno le stesse per tutto l'anno  = Ha senso questo raggruppamento
df %>% group_by(tipo, Section, Month) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View()
df %>% group_by(tipo, Section, Month) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View()
13*12
112 + 108 + 124 + 129
