#keep calm: first exploration -> only aries
df = d_aries %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(numero_macchine = sum(NoMachines),
ricavi_totali = sum(GrossRevenue),
ricavo_unitario = ricavi_totali/numero_macchine,
giocate_totali = sum(Plays),
giocate_unitarie = round(giocate_totali/numero_macchine),
ricavo_per_giocata = ricavi_totali/giocate_totali) %>%
arrange(Month, Section, MachineType, Denomination) %>%
mutate(tipo = paste0(MachineType, "_", Denomination))
library(ggplot2)
ggplot(data=d, aes(x=d$Month, y = d$GrossRevenuePerMachine)) +
geom_point(alpha=.4, size=4, color="#880011") +
labs(x="Month", y="Gross Revenue per Machine") +
theme_classic()
ricavi_mese = df %>%
group_by(Month) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario),
numero_macchine_medie = mean(numero_macchine),
varianza_macchine = sqrt(var(numero_macchine)))
ggplot(data=ricavi_mese, aes(x=ricavi_mese$Month, y = ricavi_mese$ricavo_medio_unitario)) +
geom_line(alpha=.5, size=1, color="#880011") +
ggtitle("Ricavi per Mese") +
labs(x="Mese", y="Ricavo medio unitario") +
theme_classic()
ricavi_mese$Month = as.factor(ricavi_mese$Month)
ggplot(data=ricavi_mese, aes(x=ricavi_mese$numero_macchine_medie,
y=ricavi_mese$ricavo_medio_unitario,
colour = Month)) +
geom_point(alpha=.4, size=4) +
ggtitle("Ricavi e Numero macchine mensili") +
labs(x="Numero medio macchine", y="Ricavi medi unitari") +
theme_minimal()
ricavi_categoria = df %>%
group_by(Denomination, MachineType) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario)) %>%
mutate(type = paste0(Denomination,sep = "_", MachineType))
ggplot(data=ricavi_categoria, aes(x=ricavi_categoria$type, y = ricavi_categoria$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=3, color="#880011") +
ggtitle("Ricavi per Categoria") +
labs(x="Categoria", y="Ricavo medio unitario") +
theme_classic()
ricavi_sezione = df %>%
group_by(Section) %>%
summarise(ricavo_medio_unitario = mean(ricavo_unitario))
ggplot(data=ricavi_sezione, aes(x=ricavi_sezione$Section, y = ricavi_sezione$ricavo_medio_unitario)) +
geom_point(alpha=.5, size=3, color="#880011") +
ggtitle("Ricavi per Sezione") +
labs(x="Sezione", y="Ricavo medio unitario") +
theme_classic()
df %>%
group_by(Denomination, MachineType) %>%
summarise(n = n()) %>%
View()#13 categorie al massimo
categorie_mese =
df %>%
group_by(Month, Denomination, MachineType) %>%
summarise(n =n()) %>%
group_by(Month) %>%
summarise(numero_categorie = n()) #alla fine restano più o meno 13 = raggruppamento per categoria ha senso[per aries]
df %>%
group_by(Section, Month) %>%
summarise(n =n()) %>%
View()
# ggplot(data=df, aes(x=df$ricavo_unitario)) +
#   geom_histogram(fill="#880011") +
#   labs(x="Ricavo unitario", y="Count\nof Records") +
#   facet_wrap(~df$Month) +
#   theme_minimal()
df %>% group_by(tipo, Section) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View() #Nelle sezioni le categorie sono più o meno le stesse per tutto l'anno  = Ha senso questo raggruppamento
df %>% group_by(tipo, Section, Month) %>%
summarise(n = n()) %>%
arrange(tipo, Section) %>%
group_by(Section) %>%
summarise(n = n()) %>%
View()
df %>% group_by(Section, Month) %>%
summarise(n = n()) %>%
arrange(Section) %>%
View()
df %>% group_by(Section, Month) %>%
summarise(n = n()) %>%
arrange(Section) %>%
group_by(Section) %>%
summarise(Numero_medio_macchine = mean(n), Varianza_macchine = sqrt(var(n))) %>%
View()
df %>% group_by(Section, Month) %>%
summarise(n = n()) %>%
arrange(Section) %>%
group_by(Month) %>%
summarise(Numero_medio_macchine = mean(n), Varianza_macchine = sqrt(var(n))) %>%
View()
#######################
# "MODELLO SEMPLICE" #
######################
#Lavoriamo solamente su Aries per iniziare
if(require(linprog)==FALSE) install.packages("linprog")
library(linprog)
#Modello con vincolo semplice legato solo al quantitativo mensile
f_obj = df$ricavo_unitario #ricavi unitari = da MAX
a =  c(rep(1,473),
ifelse(df$Month == ymd("2011-09-01"), 1, 0),
ifelse(df$Month == ymd("2011-09-01"), 1, 0),
ifelse(df$Month == ymd("2011-10-01"), 1, 0),
ifelse(df$Month == ymd("2011-10-01"), 1, 0),
ifelse(df$Month == ymd("2011-11-01"), 1, 0),
ifelse(df$Month == ymd("2011-11-01"), 1, 0),
ifelse(df$Month == ymd("2011-12-01"), 1, 0),
ifelse(df$Month == ymd("2011-12-01"), 1, 0),
ifelse(df$Month == ymd("2012-01-01"), 1, 0),
ifelse(df$Month == ymd("2012-01-01"), 1, 0),
ifelse(df$Month == ymd("2012-02-01"), 1, 0),
ifelse(df$Month == ymd("2012-02-01"), 1, 0),
ifelse(df$Month == ymd("2012-03-01"), 1, 0),
ifelse(df$Month == ymd("2012-03-01"), 1, 0),
ifelse(df$Month == ymd("2012-04-01"), 1, 0),
ifelse(df$Month == ymd("2012-04-01"), 1, 0),
ifelse(df$Month == ymd("2012-05-01"), 1, 0),
ifelse(df$Month == ymd("2012-05-01"), 1, 0),
ifelse(df$Month == ymd("2012-06-01"), 1, 0),
ifelse(df$Month == ymd("2012-06-01"), 1, 0),
ifelse(df$Month == ymd("2012-07-01"), 1, 0),
ifelse(df$Month == ymd("2012-07-01"), 1, 0),
ifelse(df$Month == ymd("2012-08-01"), 1, 0),
ifelse(df$Month == ymd("2012-08-01"), 1, 0))
A = matrix(a,25,473, byrow = T) #Matrice A del modello, 1 se valore attivo, 0 altrimenti
b = c(5896, rep(c(404, 849), 12)) #upper and lower bound
constraints = c("<=", rep(c(">=", "<="), 12))
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
summary(sol)
shadow_price = sol$con
#proviamo ad aggiungere qualche vincolo
#proporzioni delle sezioni per mese
df %>%
group_by(Month, Section) %>%
summarise(Num_macchine = sum(numero_macchine)) %>%
mutate(prop_per_mese = round(Num_macchine / sum(Num_macchine), 2)) %>%
View()#il mutate perde un livello dopo il summarise
#Cerco di capire come individuare le variabili per un mese...poi estendo a tutti e 12 i mesi
#numeratore proporzione
ifelse(df$Month == ymd("2011-09-01")  & df$Section == "Boundary", 1, 0) #ok
#denominatore
ifelse(df$Month == ymd("2011-09-01"), 1, 0) #ok
#vincolo base
#0.2 <= numeratore/denominatore <= 0.3
#ma si può? forse occorre scriverlo in maniera diversa?
#No non è lineare!
x = df %>%
group_by(Month) %>%
summarise(Num_macchine = sum(numero_macchine))
variazione = round(sqrt(var(x$Num_macchine))) #potremmo usare questo per definire gli upper e lower
a1 = c(
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-10-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-11-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-12-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-01-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-02-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-03-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-04-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-05-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-06-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-07-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2012-08-01") & df$Section == "RestaurantPlaza", 1, 0)
)
A1 = matrix(a1,96,473, byrow = T)
A = rbind(A, A1)
b = c(5896, rep(c(404, 849), 12)) #upper and lower bound
b1 = c()
for (i in 1:length(x$Num_macchine)) {
inferiore = x$Num_macchine[i] - variazione
superiore = x$Num_macchine[i] + variazione
append(b1, c(inferiore, superiore))
}
b = c(5896, rep(c(404, 849), 12))
constraints = c("<=", rep(c(">=", "<="), 12), rep(c(">=", "<="), 48))
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
summary(sol)
shadow_price = sol$con
#riga 26 ????
View(shadow_price)
b1 = c()
for (i in 1:length(x$Num_macchine)) {
b1[i] = x$Num_macchine[i] - variazione
superiore = x$Num_macchine[i] + variazione
append(b1, superiore)
}
inferiore = c()
superiore = c()
for (i in 1:length(x$Num_macchine)) {
inferiore[i] = x$Num_macchine[i] - variazione
superiore[i] = x$Num_macchine[i] + variazione
}
rm(b1)
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
c(rbind(inferiore,superiore))
rbind(inferiore,superiore)
v = c(rbind(inferiore,superiore)) #unire 2 vettori in modo alternato
v
v
View(A1)
b = c(5896, rep(c(404, 849), 12), rep(c(404,849), 48))
constraints = c("<=", rep(c(">=", "<="), 12), rep(c(">=", "<="), 48))
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
summary(sol)
shadow_price = sol$con
b = c(5896, rep(c(404, 849), 12), rep(c(0.2*404,0.3*849), 48))
b
#proporzioni delle sezioni per mese
df %>%
group_by(Month, Section) %>%
summarise(Num_macchine = sum(numero_macchine)) %>%
mutate(prop_per_mese = round(Num_macchine / sum(Num_macchine), 2)) %>%
View()#il mutate perde un livello dopo il summarise
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
summary(sol)
shadow_price = sol$con
12*4*2
es = cbind(A,b)
View(es)
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Boundary", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Entrance", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "Interior", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
ifelse(df$Month == ymd("2011-09-01") & df$Section == "RestaurantPlaza", 1, 0),
A1 = matrix(a1,96,473, byrow = T)
a = 2011:2013
a = 2011:2012
y = 2011:2012
m = 09:08
a = 2011-09-01:2012-08-01
a = ymd("2011-09-01)":ymd("2012-08-01")
a = ymd("2011-09-01)":ymd("2012-08-01"))
seq(ymd('2011-09-01'),ymd('2012-08-01'), by = 'month')
a = seq(ymd('2011-09-01'),ymd('2012-08-01'), by = 'month')
d = seq(ymd('2011-09-01'),ymd('2012-08-01'), by = 'month')
unique(df$Month)
e = ymd(unique(df$Month))
s = unique(df$Section)
df[,"Section"]
s = unique(df[,"Section"])
View(s)
s = c(unique(df[,"Section"]))
View(s)
str(df)
df$"Section"
s = unique(df$"Section")
for (i in 1:2) {
z = c(3)
}
appen(z, 3)
z = c()
for (i in 1:2) {
appen(z, 3)
}
for (i in 1:2) {
append(z, 3)
}
z = c()
for (i in 1:2) {
append(z, 3)
}
for (i in 1:2) {
z = append(z, 3)
}
for (i in 1:4) {
z = append(z, i+1)
}
z = c()
for (i in 1:4) {
z = append(z, i+1)
}
z = c()
for (i in 1:4) {
z = append(z, c(i,i+1))
}
a = c()
for (i in 1:12) {
for (k in 1:4) {
for (t in 1:2) {
a = append(a, ifelse(df$Month == d[i] & df$Section ==s[i], 1, 0))
}
}
}
a == a1
all(a == a1)
a = c()
for (i in 1:12) {
for (k in 1:4) {
a = append(a, ifelse(df$Month == d[i] & df$Section ==s[i], 1, 0))
}
}
a
a = c(rbind(a,a))
all(a==a1)
a = c()
for (i in 1:12) {
for (k in 1:4) {
a = append(a, ifelse(df$Month == d[i] & df$Section ==s[k], 1, 0))
}
}
a = c(rbind(a,a))
all(a==a1)
a = matrix(a,96,473, byrow = T)
View(a)
a = c()
for (i in 1:12) {
for (k in 1:4) {
for (t in 1:2) {
a = append(a, ifelse(df$Month == d[i] & df$Section ==s[k], 1, 0))
}
}
}
a = matrix(a,96,473, byrow = T)
a =  c(rep(1,473),
ifelse(df$Month == ymd("2011-09-01"), 1, 0),
ifelse(df$Month == ymd("2011-09-01"), 1, 0),
ifelse(df$Month == ymd("2011-10-01"), 1, 0),
ifelse(df$Month == ymd("2011-10-01"), 1, 0),
ifelse(df$Month == ymd("2011-11-01"), 1, 0),
ifelse(df$Month == ymd("2011-11-01"), 1, 0),
ifelse(df$Month == ymd("2011-12-01"), 1, 0),
ifelse(df$Month == ymd("2011-12-01"), 1, 0),
ifelse(df$Month == ymd("2012-01-01"), 1, 0),
ifelse(df$Month == ymd("2012-01-01"), 1, 0),
ifelse(df$Month == ymd("2012-02-01"), 1, 0),
ifelse(df$Month == ymd("2012-02-01"), 1, 0),
ifelse(df$Month == ymd("2012-03-01"), 1, 0),
ifelse(df$Month == ymd("2012-03-01"), 1, 0),
ifelse(df$Month == ymd("2012-04-01"), 1, 0),
ifelse(df$Month == ymd("2012-04-01"), 1, 0),
ifelse(df$Month == ymd("2012-05-01"), 1, 0),
ifelse(df$Month == ymd("2012-05-01"), 1, 0),
ifelse(df$Month == ymd("2012-06-01"), 1, 0),
ifelse(df$Month == ymd("2012-06-01"), 1, 0),
ifelse(df$Month == ymd("2012-07-01"), 1, 0),
ifelse(df$Month == ymd("2012-07-01"), 1, 0),
ifelse(df$Month == ymd("2012-08-01"), 1, 0),
ifelse(df$Month == ymd("2012-08-01"), 1, 0))
A = matrix(a,25,473, byrow = T) #Matrice A del modello, 1 se valore attivo, 0 altrimenti
a1 = c()
for (i in 1:12) {
for (k in 1:4) {
for (t in 1:2) {
a1 = append(a1, ifelse(df$Month == d[i] & df$Section ==s[k], 1, 0))
}
}
}
A1 = matrix(a1,96,473, byrow = T)
A = rbind(A, A1)
inferiore = c()
superiore = c()
for (i in 1:length(x$Num_macchine)) {
inferiore[i] = x$Num_macchine[i] - variazione
superiore[i] = x$Num_macchine[i] + variazione
}
v = c(rbind(inferiore,superiore)) #unire 2 vettori in modo alternato
b = c(5896, rep(c(404, 849), 12), rep(c(0.2*404,0.3*849), 48))
constraints = c("<=", rep(c(">=", "<="), 12), rep(c(">=", "<="), 48))
sol <- solveLP(f_obj, b, A, maximum = TRUE, constraints)
summary(sol)
shadow_price = sol$con
View(shadow_price)
