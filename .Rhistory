#Caricamento Dataset
setwd("C:\\Users\\Donatella\\Desktop\\bicocca\\GITHUB\\Decision_models")
library(readxl)
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
#Status Dataset
library(funModeling)
library(dplyr)
status = df_status(d, print_results = F)
summary(d$Month) #circa 12 mesi
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
d_aries = d %>%
filter(Casino == "Aries")
d_aries %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali Aries per mese = OK!
d_libra = d %>%
filter(Casino == "Libra")
d_libra %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines))#macchine totali Libra per mese = OK!
#numero di "macchine" che posso avere
d %>%
group_by(Denomination, MachineName, MachineType, Model) %>%
summarise(n = n()) %>%
View() #566 -> NON SO SE ANCORA UTILE
status
unique(d$Denomination) #6 unique value
unique(d$MachineType) #3 unique value
glimpse(d)
#Aries
d_aries = d %>%
filter(Casino == "Aries")
status_aries = df_status(d_aries, F)
#Libra
d_libra = d %>%
filter(Casino == "Libra")
status_libra = df_status(d_libra, F)
library(lubridate)
#Considero solo il mese di Settembre
sept_lib = d_libra %>%
filter (Month == ymd("2011-09-01")) #Voi usate pure as.Date()
sum(sept_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
sept_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
section_sept_lib = sept_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
View(es)
opt_lib = d_libra %>%
filter (Month == ymd("2011-10-01")) #Voi usate pure as.Date()
sum(opt_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
opt_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
#suddivisione anche per sezioni...sempre mese di Ottobre e casino Libra
section_opt_lib = opt_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
nov_lib = d_libra %>%
filter (Month == ymd("2011-11-01")) #Voi usate pure as.Date()
sum(nov_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
nov_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
#suddivisione anche per sezioni...sempre mese di Ottobre e casino Libra
section_nov_lib = opt_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
View(es)
Sistemato1 = d_libra %>%
group_by(Denomination, MachineType, Month) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
Sistemato2 = d_libra %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#spostamento tra le sezioni. Problema: perdiamo la serie storica perchè se è possibile che alcune
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#spostamento tra le sezioni. Problema: perdiamo la serie storica perchè se è possibile che alcune
#categorie di macchine, che presentano più di una macchina (num_macchine > 1) vengano divise tra 2
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print( getwd() )
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print(getwd())
library(readxl)
d = read_excel("Lucky Duck Entertainment revenue 2013.xls", na = c(".", "NA", "NaN"))
#Status Dataset
library(funModeling)
library(dplyr)
status = df_status(d, print_results = F)
summary(d$Month) #circa 12 mesi
d %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali di LDE per mese
d_aries = d %>%
filter(Casino == "Aries")
d_aries %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines)) #macchine totali Aries per mese = OK!
d_libra = d %>%
filter(Casino == "Libra")
d_libra %>%
group_by(Month) %>%
summarise(n_mac = sum(NoMachines))#macchine totali Libra per mese = OK!
#numero di "macchine" che posso avere
slots_unique <- d %>%
group_by(Denomination, MachineName, MachineType, Model, Manufacturer) %>%
summarise(monthRevenue =
mean(GrossRevenuePerMachine),
monthPlays = mean(PlaysPerMachine),
revenuePerPlay = monthRevenue / monthPlays , count = n())
View(slots_unique) #556
status
unique(d$Denomination) #6 unique value
unique(d$MachineType) #3 unique value
glimpse(d)
#Aries
d_aries = d %>%
filter(Casino == "Aries")
status_aries = df_status(d_aries, F)
#Libra
d_libra = d %>%
filter(Casino == "Libra")
status_libra = df_status(d_libra, F)
library(lubridate)
#Considero solo il mese di Settembre
sept_lib = d_libra %>%
filter (Month == ymd("2011-09-01")) #Voi usate pure as.Date()
sum(sept_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
sept_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
<<<<<<< HEAD
section_sept_lib = sept_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
View(es)
opt_lib = d_libra %>%
filter (Month == ymd("2011-10-01")) #Voi usate pure as.Date()
sum(opt_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
opt_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
#suddivisione anche per sezioni...sempre mese di Ottobre e casino Libra
section_opt_lib = opt_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
nov_lib = d_libra %>%
filter (Month == ymd("2011-11-01")) #Voi usate pure as.Date()
sum(nov_lib$NoMachines) #numero macchine mese di settembre = 230 (Uguale al raggruppamento fatto al I incontro)
nov_lib %>%
group_by(Denomination, MachineType) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
#suddivisione anche per sezioni...sempre mese di Ottobre e casino Libra
section_nov_lib = opt_lib %>%
group_by(Denomination, MachineType, Section) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
View(es)
Sistemato1 = d_libra %>%
group_by(Denomination, MachineType, Month) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination) #ok
Sistemato2 = d_libra %>%
group_by(Denomination, MachineType, Section, Month) %>%
summarise(num_macchine = sum(NoMachines),
profitto_per_macchina = sum(GrossRevenue)/num_macchine, #profitto per macchina di quella categoria
giocate_per_macchina = sum(Plays)/num_macchine) %>% #giocata per macchina di quella categoria
arrange(MachineType, Denomination, Section) #ok
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#spostamento tra le sezioni. Problema: perdiamo la serie storica perchè se è possibile che alcune
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#spostamento tra le sezioni. Problema: perdiamo la serie storica perchè se è possibile che alcune
#categorie di macchine, che presentano più di una macchina (num_macchine > 1) vengano divise tra 2
#un'osservazione corrisponde ad una determinata categoria in una determinata sezione del casino Libra,
#questo dataset è strettamente dipendente a Sistemato1: guardate la categoria 0.01 reel. Ci sono
#esattamente 8 osservazioni come in Sistemato1, ma in questo caso abbiamo informazioni circa lo
#spostamento tra le sezioni. Problema: perdiamo la serie storica perchè se è possibile che alcune
#categorie di macchine, che presentano più di una macchina (num_macchine > 1) vengano divise tra 2
#o più sezioni in uno stesso mese. Esempio lampante è la categoria 0.02 reel [vedete].
View(Sistemato1)
